
:context: nodes-configuring-gpus
[id="nodes-configuring-gpus"]
= Detecting and using node hardware features
include::modules/common-attributes.adoc[]

toc::[]

== Understanding Node Feature Discovery

The Node Feature Discovery (NFD) Operator manages detection of hardware features
available on each node of an {product-title} cluster and advertises those
features using node labels. The NFD Operator manages the installation and
lifecycle of the NFD DaemonSet.

CPU features managed by NFD include:

* `cpuid`
* `hardware_multithreading`
* `power`
* `pstate`

Kernel features managed by NFD include:

* `config`
* `selinux_enabled`
* `version`
* `os_version`

Other features managed by NFD include:

* NVMe
* NUMA
* SR-IOV
* GPUs

[id="nodes-configuring-gpus--configuration-parameters_{context}"]
== Configuring worker nodes to use GPUs
.Procedure

. Deploy the Node Feature Discovery (NFD) Operator using OperatorHub.
+
NFD is deployed and running on all nodes, running 3 CPU worker
nodes and 1 GPU worker node.
+
NFD has labeled the nodes with the discovered PCI devices.

. Get the PCI labels of the node:
+
----
$ oc describe node <cpu_node_hostname> | egrep `Roles:|pci-`
----

. Deploy the NVIDIA GPU Operator using OperatorHub.

. Gather some logs and watch the Pod creation:
+
--
* First, the NVIDIA driver container is deployed. Every stage is validated with a
validation step and Pod.
* The second state deploys the NVIDIA device plug-in.
* The last state deploys the NVIDIA `node-exporter` Pod with GPU metrics.
--

. Check Prometheus and Grafana for GPU monitoring data. NGC templates are
installed for deploying TensorRT, DIGITS, and RAPIDS.

////
include::modules/nodes-nodes-managing-about.adoc[leveloffset=+1]
////
